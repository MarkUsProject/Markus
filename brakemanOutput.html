<!DOCTYPE HTML SYSTEM>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Brakeman Report</title>
  <script type="text/javascript" src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.9/js/jquery.dataTables.min.js"></script>
  <script type="text/javascript">
    function toggle(context) {
      var elem = document.getElementById(context);

      if (elem.style.display != "block")
        elem.style.display = "block";
      else
        elem.style.display = "none";

      elem.parentNode.scrollIntoView();
    }

    $(document).ready(function() {
      $('table').DataTable({
        searching: false,
        paging:    false,
        info:      false
      });
    });
  </script>
  <style>
    /* CSS style used for HTML reports */

body {
  font-family: sans-serif;
  color: #161616;
}

a {
  color: #161616;
}

p {
  font-weight: bold;
  font-size: 11pt;
  color: #2D0200;
 }

 th {
   background-color: #980905;
   border-bottom: 5px solid #530200;
   color: white;
   font-size: 11pt;
   padding: 1px 8px 1px 8px;
 }

 td {
   border-bottom: 2px solid white;
   font-family: monospace;
   padding: 5px 8px 1px 8px;
 }

 table {
   background-color: #FCF4D4;
   border-collapse: collapse;
 }

 h1 {
   color: #2D0200;
   font-size: 14pt;
 }

 h2 {
   color: #2D0200;
   font-size: 12pt;
 }

 span.high-confidence {
   font-weight:bold;
   color: red;
 }

 span.med-confidence {
 }

 span.weak-confidence {
   color:gray;
 }

 div.warning_message {
   cursor: pointer;
 }

 div.warning_message:hover {
   background-color: white;
 }

 table caption {
   background-color: #FFE;
   padding: 2px;
 }

 table.context {
   margin-top: 5px;
   margin-bottom: 5px;
   border-left: 1px solid #90e960;
   color: #212121;
 }

 tr.context {
   background-color: white;
 }

 tr.first {
   border-top: 1px solid #7ecc54;
   padding-top: 2px;
 }

 tr.error {
  background-color: #f4c1c1 !important
 }

 tr.near_error {
  background-color: #f4d4d4 !important
 }

 tr.alt {
   background-color: #e8f4d4;
 }

 td.context {
   padding: 2px 10px 0px 6px;
   border-bottom: none;
 }

 td.context_line {
   padding: 2px 8px 0px 7px;
   border-right: 1px solid #b3bda4;
   border-bottom: none;
   color: #6e7465;
 }

 pre.context {
   margin-bottom: 1px;
 }

 .user_input {
   background-color: #fcecab;
 }

 div.render_path {
   display: none;
   background-color: #ffe;
   padding: 5px;
   margin: 2px 0px 2px 0px;
 }

 div.template_name {
   cursor: pointer;
 }

 div.template_name:hover {
   background-color: white;
 }

  </style>
</head>
<body>

<h1>Brakeman Report</h1>
<table>
  <thead>
    <tr>
      <th>Application Path</th>
      <th>Rails Version</th>
      <th>Brakeman Version</th>
      <th>Report Time</th>
      <th>Checks Performed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>/home/vagrant/Markus</td>
      <td>4.2.10</td>
      <td>4.3.1
      <td>
        2018-06-23 17:58:32 -0400<br><br>
        13.881788948 seconds
      </td>
      <td>BasicAuth, BasicAuthTimingAttack, ContentTag, CreateWith, CrossSiteScripting, DefaultRoutes, Deserialize, DetailedExceptions, DigestDoS, DynamicFinders, EscapeFunction, Evaluation, Execute, FileAccess, FileDisclosure, FilterSkipping, ForgerySetting, HeaderDoS, I18nXSS, JRubyXML, JSONEncoding, JSONParsing, LinkTo, LinkToHref, MailTo, MassAssignment, MimeTypeDoS, ModelAttrAccessible, ModelAttributes, ModelSerialize, NestedAttributes, NestedAttributesBypass, NumberToCurrency, PermitAttributes, QuoteTableName, Redirect, RegexDoS, Render, RenderDoS, RenderInline, ResponseSplitting, RouteDoS, SQL, SQLCVEs, SSLVerify, SafeBufferManipulation, SanitizeMethods, SelectTag, SelectVulnerability, Send, SendFile, SessionManipulation, SessionSettings, SimpleFormat, SingleQuotes, SkipBeforeFilter, StripTags, SymbolDoSCVE, TranslateBug, UnsafeReflection, ValidationRegex, WithoutProtection, XMLDoS, YAMLParsing</td>
    </tr>
  </tbody>
</table>
<br>
<h2 id='summary'>Summary</h2>
<table>
  <thead>
    <tr>
      <th>Scanned/Reported</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Controllers</td>
      <td>36</td>
    </tr>
    <tr>
      <td>Models</td>
      <td>66</td>
    </tr>
    <tr>
      <td>Templates</td>
      <td>325</td>
    </tr>
    <tr>
      <td>Errors</td>
      <td>0</td>
    </tr>
    <tr>
      <td>Security Warnings</td>
      <td>57 <span class='high-confidence'>(19)</span></td>
    </tr>
  
    <tr>
      <td>Ignored Warnings</td>
      <td>0</td>
    </tr>
  
  </tbody>
</table>
<br>
<table>
  <thead>
    <tr>
      <th>Warning Type</th>
      <th>Total</th>
    </tr>
  </thead>
  <tbody>
  
    <tr>
      <td>Command Injection</td>
      <td>7</td>
    </tr>
  
    <tr>
      <td>Cross-Site Request Forgery</td>
      <td>1</td>
    </tr>
  
    <tr>
      <td>Cross-Site Scripting</td>
      <td>13</td>
    </tr>
  
    <tr>
      <td>Dynamic Render Path</td>
      <td>1</td>
    </tr>
  
    <tr>
      <td>File Access</td>
      <td>18</td>
    </tr>
  
    <tr>
      <td>Format Validation</td>
      <td>4</td>
    </tr>
  
    <tr>
      <td>Information Disclosure</td>
      <td>1</td>
    </tr>
  
    <tr>
      <td>Remote Code Execution</td>
      <td>10</td>
    </tr>
  
    <tr>
      <td>SQL Injection</td>
      <td>2</td>
    </tr>
  
  </tbody>
</table>
<br>
<h2>Security Warnings</h2>  
<table>
  <thead>
    <tr>
      <th>Confidence</th>
      <th>Class</th>
      <th>Method</th>
      <th>Warning Type</th>
      <th>Message</th>
    </tr>
  </thead>
  <tbody>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>AutotestScriptsJob</td>
      <td>perform</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
      <td><div class='warning_message' onClick="toggle('context11');toggle('message11');toggle('full_message11')" ><span id='message11' style='display:block' >Possible command injection near line 37: Open3.capture3(&quot;scp&quot;, &quot;-o&quot;, &quot;PasswordAuthentication=no&quot;, &quot;-o...</span><span id='full_message11' style='display:none'>Possible command injection near line 37: Open3.capture3(&quot;scp&quot;, &quot;-o&quot;, &quot;PasswordAuthentication=no&quot;, &quot;-o&quot;, &quot;ChallengeResponseAuthentication=no&quot;, &quot;-rq&quot;, &quot;&#39;#{File.join(AutomatedTestsClientHelper::ASSIGNMENTS_DIR, <span class="user_input">Assignment.find(assignment_id).short_identifier</span>)}&#39;/. #{MarkusConfigurator.autotest_server_username}@#{MarkusConfigurator.autotest_server_host}:&#39;#{ssh.exec!(&quot;mktemp -d --tmpdir=&#39;#{MarkusConfigurator.autotest_server_dir}&#39;&quot;).strip}&#39;&quot;)</span><table id='context11' class='context' style='display:none'><caption>app/jobs/autotest_scripts_job.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>32</pre>
          </td>
          <td class='context'>
            <pre class='context'>        # tests executed locally or remotely with authentication</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>        Net::SSH.start(server_host, server_username, auth_methods: [&#39;publickey&#39;]) do |ssh|</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>          server_path = ssh.exec!(&quot;mktemp -d --tmpdir=&#39;#{server_path}&#39;&quot;).strip # create temp subfolder</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>          # copy all files using passwordless scp (natively, the net-scp gem has poor performance)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>          Open3.capture3(&quot;scp&quot;, &quot;-o&quot;, &quot;PasswordAuthentication=no&quot;, &quot;-o&quot;, &quot;ChallengeResponseAuthentication=no&quot;, &quot;-rq&quot;,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>                         &quot;&#39;#{assignment_tests_path}&#39;/. #{server_username}@#{server_host}:&#39;#{server_path}&#39;&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>          server_params[:files_path] = server_path</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>          out = ssh.exec!(&quot;#{server_command} scripts &#39;#{JSON.generate(server_params)}&#39;&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>          # TODO: use out for something?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>SubmissionsController</td>
      <td>download_groupings_files</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context12');toggle('message12');toggle('full_message12')" ><span id='message12' style='display:block' >Model attribute used in file name near line 579: File.delete((&quot;tmp/&quot; + (((Assignment.find(params[:ass...</span><span id='full_message12' style='display:none'>Model attribute used in file name near line 579: File.delete((&quot;tmp/&quot; + (((<span class="user_input">Assignment.find(params[:assignment_id]).short_identifier</span> + &quot;_&quot;) + current_user.user_name) + &quot;.zip&quot;).tr(&quot;/&quot;, &quot;_&quot;)))</span><table id='context12' class='context' style='display:none'><caption>app/controllers/submissions_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>574</pre>
          </td>
          <td class='context'>
            <pre class='context'>    zip_name = short_id + &#39;_&#39; + current_user.user_name + &#39;.zip&#39;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>575</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ## check if there is a &#39;/&#39; in the file name to replace by &#39;_&#39;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>576</pre>
            </td>
            <td class='context'>
              <pre class='context'>    zip_path = &#39;tmp/&#39; + zip_name.tr(&#39;/&#39;, &#39;_&#39;)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>578</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ## delete the old file if it exists</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>579</pre>
            </td>
            <td class='context'>
              <pre class='context'>    File.delete(zip_path) if File.exist?(zip_path)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>581</pre>
            </td>
            <td class='context'>
              <pre class='context'>    groupings = Grouping.get_groupings_for_assignment(assignment,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>582</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                                      current_user)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>584</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ## build the zip file</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>SubmissionsController</td>
      <td>download_groupings_files</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context30');toggle('message30');toggle('full_message30')" ><span id='message30' style='display:block' >Model attribute used in file name near line 617: send_file((&quot;tmp/&quot; + (((Assignment.find(params[:assig...</span><span id='full_message30' style='display:none'>Model attribute used in file name near line 617: send_file((&quot;tmp/&quot; + (((<span class="user_input">Assignment.find(params[:assignment_id]).short_identifier</span> + &quot;_&quot;) + current_user.user_name) + &quot;.zip&quot;).tr(&quot;/&quot;, &quot;_&quot;)), :disposition =&gt; &quot;inline&quot;, :filename =&gt; (((<span class="user_input">Assignment.find(params[:assignment_id]).short_identifier</span> + &quot;_&quot;) + current_user.user_name) + &quot;.zip&quot;))</span><table id='context30' class='context' style='display:none'><caption>app/controllers/submissions_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>612</pre>
          </td>
          <td class='context'>
            <pre class='context'>        end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>613</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>614</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>616</pre>
            </td>
            <td class='context'>
              <pre class='context'>    ## Send the Zip file</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>617</pre>
            </td>
            <td class='context'>
              <pre class='context'>    send_file zip_path, disposition: &#39;inline&#39;, filename: zip_name</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>618</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>620</pre>
            </td>
            <td class='context'>
              <pre class='context'>  ##</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>621</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # Check the status of collection for all groupings</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>622</pre>
            </td>
            <td class='context'>
              <pre class='context'>  ##</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td></td>
      <td></td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/information_disclosure/">Information Disclosure</a></td>
      <td>Detailed exceptions are enabled in production</td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>AssignmentsController</td>
      <td>process_assignment_form</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/remote_code_execution/">Remote Code Execution</a></td>
      <td><div class='warning_message' onClick="toggle('context38');toggle('message38');toggle('full_message38')" ><span id='message38' style='display:block' >Unsafe reflection method const_get called with parameter value near line 967: SubmissionRule.const_ge...</span><span id='full_message38' style='display:none'>Unsafe reflection method const_get called with parameter value near line 967: SubmissionRule.const_get((assignment.submission_rule.class.to_s or <span class="user_input">params[:assignment][:submission_rule_attributes][:type]</span>))</span><table id='context38' class='context' style='display:none'><caption>app/controllers/assignments_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>962</pre>
          </td>
          <td class='context'>
            <pre class='context'>    end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>964</pre>
            </td>
            <td class='context'>
              <pre class='context'>    [NoLateSubmissionRule, GracePeriodSubmissionRule,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>965</pre>
            </td>
            <td class='context'>
              <pre class='context'>     PenaltyPeriodSubmissionRule, PenaltyDecayPeriodSubmissionRule]</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>966</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if SubmissionRule.const_defined?(rule_name)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>967</pre>
            </td>
            <td class='context'>
              <pre class='context'>      potential_rule = SubmissionRule.const_get(rule_name)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>968</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>969</pre>
            </td>
            <td class='context'>
              <pre class='context'>      raise SubmissionRule::InvalidRuleType, rule_name</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>970</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>972</pre>
            </td>
            <td class='context'>
              <pre class='context'>    # If the submission rule was changed, we need to do a more complicated</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>CriteriaController</td>
      <td>create</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/remote_code_execution/">Remote Code Execution</a></td>
      <td><div class='warning_message' onClick="toggle('context34');toggle('message34');toggle('full_message34')" ><span id='message34' style='display:block' >Unsafe reflection method constantize called with parameter value near line 31: params[:criterion_type...</span><span id='full_message34' style='display:none'>Unsafe reflection method constantize called with parameter value near line 31: <span class="user_input">params[:criterion_type]</span>.constantize</span><table id='context34' class='context' style='display:none'><caption>app/controllers/criteria_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>26</pre>
          </td>
          <td class='context'>
            <pre class='context'>    if @assignment.released_marks.any?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash_now(:error, t(&#39;criteria.errors.messages.released_marks&#39;))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>      head :bad_request</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>      return</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>    criterion_class = params[:criterion_type].constantize</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @criterion = criterion_class.new</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @criterion.set_default_levels if params[:criterion_type] == &#39;RubricCriterion&#39;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @criterion.update(name: params[:new_criterion_prompt],</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>                             assignment_id: @assignment.id,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>                             max_mark: params[:max_mark_prompt],</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>CriteriaController</td>
      <td>edit</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/remote_code_execution/">Remote Code Execution</a></td>
      <td><div class='warning_message' onClick="toggle('context35');toggle('message35');toggle('full_message35')" ><span id='message35' style='display:block' >Unsafe reflection method constantize called with parameter value near line 49: params[:criterion_type...</span><span id='full_message35' style='display:none'>Unsafe reflection method constantize called with parameter value near line 49: <span class="user_input">params[:criterion_type]</span>.constantize</span><table id='context35' class='context' style='display:none'><caption>app/controllers/criteria_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>44</pre>
          </td>
          <td class='context'>
            <pre class='context'>      head :unprocessable_entity</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def edit</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>49</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @criterion = params[:criterion_type].constantize.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>50</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @assignment = @criterion.assignment</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>51</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @assignment.released_marks.any?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>52</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash_now(:error, t(&#39;criteria.errors.messages.released_marks&#39;))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>CriteriaController</td>
      <td>destroy</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/remote_code_execution/">Remote Code Execution</a></td>
      <td><div class='warning_message' onClick="toggle('context36');toggle('message36');toggle('full_message36')" ><span id='message36' style='display:block' >Unsafe reflection method constantize called with parameter value near line 57: params[:criterion_type...</span><span id='full_message36' style='display:none'>Unsafe reflection method constantize called with parameter value near line 57: <span class="user_input">params[:criterion_type]</span>.constantize</span><table id='context36' class='context' style='display:none'><caption>app/controllers/criteria_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>52</pre>
          </td>
          <td class='context'>
            <pre class='context'>      flash_now(:error, t(&#39;criteria.errors.messages.released_marks&#39;))</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>53</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def destroy</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @criterion = params[:criterion_type].constantize.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @assignment = @criterion.assignment</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @assignment.released_marks.any?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash_now(:error, t(&#39;criteria.errors.messages.released_marks&#39;))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>      return</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>CriteriaController</td>
      <td>update</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/remote_code_execution/">Remote Code Execution</a></td>
      <td><div class='warning_message' onClick="toggle('context37');toggle('message37');toggle('full_message37')" ><span id='message37' style='display:block' >Unsafe reflection method constantize called with parameter value near line 70: params[:criterion_type...</span><span id='full_message37' style='display:none'>Unsafe reflection method constantize called with parameter value near line 70: <span class="user_input">params[:criterion_type]</span>.constantize</span><table id='context37' class='context' style='display:none'><caption>app/controllers/criteria_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>65</pre>
          </td>
          <td class='context'>
            <pre class='context'>    flash_message(:success, t(&#39;flash.criteria.delete.success&#39;))</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>    criterion_type = params[:criterion_type]</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>70</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @criterion = criterion_type.constantize.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>71</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @assignment = @criterion.assignment</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>72</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if @assignment.released_marks.any?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>73</pre>
            </td>
            <td class='context'>
              <pre class='context'>      flash_now(:error, t(&#39;criteria.errors.messages.released_marks&#39;))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>74</pre>
            </td>
            <td class='context'>
              <pre class='context'>      head :bad_request</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>75</pre>
            </td>
            <td class='context'>
              <pre class='context'>      return</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>NotesController</td>
      <td>notes_dialog</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/remote_code_execution/">Remote Code Execution</a></td>
      <td><div class='warning_message' onClick="toggle('context39');toggle('message39');toggle('full_message39')" ><span id='message39' style='display:block' >Unsafe reflection method const_get called with parameter value near line 9: Kernel.const_get(params[:...</span><span id='full_message39' style='display:none'>Unsafe reflection method const_get called with parameter value near line 9: Kernel.const_get(<span class="user_input">params[:noteable_type]</span>)</span><table id='context39' class='context' style='display:none'><caption>app/controllers/notes_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>5</pre>
          </td>
          <td class='context'>
            <pre class='context'>  # TODO this method needs explaining ! What is return_id ?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def notes_dialog</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @return_id = params[:id]</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @cls = params[:noteable_type]</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @noteable = Kernel.const_get(@cls).find_by_id(params[:noteable_id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @cont = params[:controller_to]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @action = params[:action_to]</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @highlight_field = params[:highlight_field]</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @number_of_notes_field = params[:number_of_notes_field]</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>AnnotationCategoriesController</td>
      <td>yml_upload</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/unsafe_deserialization">Remote Code Execution</a></td>
      <td><div class='warning_message' onClick="toggle('context1');toggle('message1');toggle('full_message1')" ><span id='message1' style='display:block' >YAML.load called with parameter value near line 207: YAML.load(params[:annotation_category_list_yml]....</span><span id='full_message1' style='display:none'>YAML.load called with parameter value near line 207: YAML.load(<span class="user_input">params[:annotation_category_list_yml].utf8_encode(params[:encoding])</span>)</span><table id='context1' class='context' style='display:none'><caption>app/controllers/annotation_categories_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>202</pre>
          </td>
          <td class='context'>
            <pre class='context'>    file = params[:annotation_category_list_yml]</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>203</pre>
            </td>
            <td class='context'>
              <pre class='context'>    annotation_category_number = 0</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>204</pre>
            </td>
            <td class='context'>
              <pre class='context'>    annotation_line = 0</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>205</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless file.blank?</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>206</pre>
            </td>
            <td class='context'>
              <pre class='context'>      begin</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>207</pre>
            </td>
            <td class='context'>
              <pre class='context'>        annotations = YAML::load(file.utf8_encode(encoding))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>208</pre>
            </td>
            <td class='context'>
              <pre class='context'>      rescue Psych::SyntaxError =&gt; e</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>209</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash_message(:error,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>210</pre>
            </td>
            <td class='context'>
              <pre class='context'>                      t(&#39;upload_errors.syntax_error&#39;, error: &quot;#{e}&quot;))</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>211</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to action: &#39;index&#39;, assignment_id: @assignment.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>212</pre>
            </td>
            <td class='context'>
              <pre class='context'>        return</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>AssignmentsController</td>
      <td>upload_assignment_list</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/unsafe_deserialization">Remote Code Execution</a></td>
      <td><div class='warning_message' onClick="toggle('context2');toggle('message2');toggle('full_message2')" ><span id='message2' style='display:block' >YAML.load called with parameter value near line 637: YAML.load(params[:assignment_list].utf8_encode(p...</span><span id='full_message2' style='display:none'>YAML.load called with parameter value near line 637: YAML.load(<span class="user_input">params[:assignment_list].utf8_encode(params[:encoding])</span>)</span><table id='context2' class='context' style='display:none'><caption>app/controllers/assignments_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>632</pre>
          </td>
          <td class='context'>
            <pre class='context'>        unless result[:valid_lines].empty?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>633</pre>
            </td>
            <td class='context'>
              <pre class='context'>          flash_message(:success, result[:valid_lines])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>634</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>635</pre>
            </td>
            <td class='context'>
              <pre class='context'>      when &#39;yml&#39;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>636</pre>
            </td>
            <td class='context'>
              <pre class='context'>        begin</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>637</pre>
            </td>
            <td class='context'>
              <pre class='context'>          map = YAML::load(assignment_list)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>638</pre>
            </td>
            <td class='context'>
              <pre class='context'>          map[:assignments].map do |row|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>639</pre>
            </td>
            <td class='context'>
              <pre class='context'>            row[:submission_rule] = NoLateSubmissionRule.new</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>640</pre>
            </td>
            <td class='context'>
              <pre class='context'>            row[:assignment_stat] = AssignmentStat.new</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>641</pre>
            </td>
            <td class='context'>
              <pre class='context'>            row[:token_period] = 1</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>642</pre>
            </td>
            <td class='context'>
              <pre class='context'>            row[:non_regenerating_tokens] = false</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>CriteriaController</td>
      <td>upload_yml</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/unsafe_deserialization">Remote Code Execution</a></td>
      <td><div class='warning_message' onClick="toggle('context3');toggle('message3');toggle('full_message3')" ><span id='message3' style='display:block' >YAML.load called with parameter value near line 156: YAML.load(params[:yml_upload][:rubric].utf8_enco...</span><span id='full_message3' style='display:none'>YAML.load called with parameter value near line 156: YAML.load(<span class="user_input">params[:yml_upload][:rubric].utf8_encode(params[:encoding])</span>)</span><table id='context3' class='context' style='display:none'><caption>app/controllers/criteria_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>151</pre>
          </td>
          <td class='context'>
            <pre class='context'>    file = params[:yml_upload][:rubric]</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>152</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless file.blank?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>153</pre>
            </td>
            <td class='context'>
              <pre class='context'>      begin</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>154</pre>
            </td>
            <td class='context'>
              <pre class='context'>        encoding = params[:encoding]</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>155</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # Note: this parsing does not output entries with repeated names.</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>156</pre>
            </td>
            <td class='context'>
              <pre class='context'>        criteria = YAML::load(file.utf8_encode(encoding))</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>157</pre>
            </td>
            <td class='context'>
              <pre class='context'>      rescue Psych::SyntaxError =&gt; e</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>158</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash_message(:error, I18n.t(&#39;criteria.upload.error.invalid_format&#39;) + &#39;  &#39; +</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>159</pre>
            </td>
            <td class='context'>
              <pre class='context'>                      I18n.t(&#39;upload_errors.syntax_error&#39;, error: &quot;#{e}&quot;))</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>160</pre>
            </td>
            <td class='context'>
              <pre class='context'>        redirect_to action: &#39;index&#39;, id: assignment.id</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>161</pre>
            </td>
            <td class='context'>
              <pre class='context'>        return</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>TagsController</td>
      <td>yml_upload</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/unsafe_deserialization">Remote Code Execution</a></td>
      <td><div class='warning_message' onClick="toggle('context4');toggle('message4');toggle('full_message4')" ><span id='message4' style='display:block' >YAML.load called with parameter value near line 175: YAML.load(params[:yml_tags].utf8_encode(params[:...</span><span id='full_message4' style='display:none'>YAML.load called with parameter value near line 175: YAML.load(<span class="user_input">params[:yml_tags].utf8_encode(params[:encoding])</span>)</span><table id='context4' class='context' style='display:none'><caption>app/controllers/tags_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>170</pre>
          </td>
          <td class='context'>
            <pre class='context'>    encoding = params[:encoding]</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>172</pre>
            </td>
            <td class='context'>
              <pre class='context'>    # Now carries out the parsing.</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>173</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if request.post? &amp;&amp; !file.blank?</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>174</pre>
            </td>
            <td class='context'>
              <pre class='context'>      begin</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>175</pre>
            </td>
            <td class='context'>
              <pre class='context'>        tags = YAML::load(file.utf8_encode(encoding))</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>177</pre>
            </td>
            <td class='context'>
              <pre class='context'>      # Handles errors associated with loads.</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>178</pre>
            </td>
            <td class='context'>
              <pre class='context'>      rescue Psych::SyntaxError =&gt; e</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>179</pre>
            </td>
            <td class='context'>
              <pre class='context'>        flash_message(:error, I18n.t(&#39;tags.upload.error&#39;) + &#39;  &#39; +</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>180</pre>
            </td>
            <td class='context'>
              <pre class='context'>            t(&#39;upload_errors.syntax_error&#39;, error: &quot;#{e}&quot;))</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>AutotestCancelJob</td>
      <td>perform</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
      <td><div class='warning_message' onClick="toggle('context7');toggle('message7');toggle('full_message7')" ><span id='message7' style='display:block' >Possible command injection near line 19: Open3.capture2e(&quot;#{MarkusConfigurator.autotest_server_comman...</span><span id='full_message7' style='display:none'>Possible command injection near line 19: Open3.capture2e(&quot;#{<span class="user_input">MarkusConfigurator.autotest_server_command</span>} cancel &#39;#{JSON.generate(:markus_address =&gt; ((host_with_port or (host_with_port + Rails.application.config.action_controller.relative_url_root))), :run_ids =&gt; test_run_ids)}&#39;&quot;)</span><table id='context7' class='context' style='display:none'><caption>app/jobs/autotest_cancel_job.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>14</pre>
          </td>
          <td class='context'>
            <pre class='context'>    cancel_command = &quot;#{server_command} cancel &#39;#{JSON.generate(server_params)}&#39;&quot;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>    begin</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if server_username.nil?</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # local cancellation with no authentication</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>        out, status = Open3.capture2e(cancel_command)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if status.exitstatus != 0</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>          raise out</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>          # TODO: use out for something?</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>AutotestRunJob</td>
      <td>enqueue_test_run</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
      <td><div class='warning_message' onClick="toggle('context8');toggle('message8');toggle('full_message8')" ><span id='message8' style='display:block' >Possible command injection near line 131: Open3.capture2e(&quot;#{MarkusConfigurator.autotest_server_comma...</span><span id='full_message8' style='display:none'>Possible command injection near line 131: Open3.capture2e(&quot;#{<span class="user_input">MarkusConfigurator.autotest_server_command</span>} run &#39;#{JSON.generate(:user_type =&gt; test_run.user.type, :markus_address =&gt; ((host_with_port or (host_with_port + Rails.application.config.action_controller.relative_url_root))), :user_api_key =&gt; test_run.user.api_key, :server_api_key =&gt; get_server_api_key, :test_scripts =&gt; test_scripts, :files_path =&gt; Dir.mktmpdir(nil, MarkusConfigurator.autotest_server_dir), :assignment_id =&gt; test_run.grouping.assignment.id, :group_id =&gt; test_run.grouping.group.id, :submission_id =&gt; test_run.submission.id, :group_repo_name =&gt; test_run.grouping.group.repo_name, :batch_id =&gt; test_run.test_batch.id, :run_id =&gt; test_run.id)}&#39;&quot;)</span><table id='context8' class='context' style='display:none'><caption>app/jobs/autotest_run_job.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>126</pre>
          </td>
          <td class='context'>
            <pre class='context'>    if ssh.nil?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>      # tests executed locally with no authentication</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>      server_path = Dir.mktmpdir(nil, server_path) # create temp subfolder</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>      FileUtils.cp_r(&quot;#{submission_path}/.&quot;, server_path) # includes hidden files</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>      server_params[:files_path] = server_path</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output, status = Open3.capture2e(&quot;#{server_command} run &#39;#{JSON.generate(server_params)}&#39;&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if status.exitstatus != 0</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>        raise output</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>    else</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>      # tests executed locally or remotely with authentication</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>AutotestRunJob</td>
      <td>enqueue_test_run</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
      <td><div class='warning_message' onClick="toggle('context9');toggle('message9');toggle('full_message9')" ><span id='message9' style='display:block' >Possible command injection near line 143: Open3.capture3(&quot;scp -o PasswordAuthentication=no -o Challen...</span><span id='full_message9' style='display:none'>Possible command injection near line 143: Open3.capture3(&quot;scp -o PasswordAuthentication=no -o ChallengeResponseAuthentication=no -rq &#39;#{<span class="user_input">File.join(File.join(AutomatedTestsClientHelper::STUDENTS_DIR, test_run.grouping.group.repo_name), test_run.grouping.assignment.repository_folder)</span>}&#39;/. #{MarkusConfigurator.autotest_server_username}@#{MarkusConfigurator.autotest_server_host}:&#39;#{ssh.exec!(&quot;mktemp -d --tmpdir=&#39;#{MarkusConfigurator.autotest_server_dir}&#39;&quot;).strip}&#39;&quot;)</span><table id='context9' class='context' style='display:none'><caption>app/jobs/autotest_run_job.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>138</pre>
          </td>
          <td class='context'>
            <pre class='context'>      server_username = MarkusConfigurator.autotest_server_username</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>139</pre>
            </td>
            <td class='context'>
              <pre class='context'>      server_path = ssh.exec!(&quot;mktemp -d --tmpdir=&#39;#{server_path}&#39;&quot;).strip # create temp subfolder</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>140</pre>
            </td>
            <td class='context'>
              <pre class='context'>      # copy all files using passwordless scp (natively, the net-scp gem has poor performance)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>141</pre>
            </td>
            <td class='context'>
              <pre class='context'>      scp_command = &quot;scp -o PasswordAuthentication=no -o ChallengeResponseAuthentication=no -rq &quot;\</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>142</pre>
            </td>
            <td class='context'>
              <pre class='context'>                    &quot;&#39;#{submission_path}&#39;/. #{server_username}@#{server_host}:&#39;#{server_path}&#39;&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>143</pre>
            </td>
            <td class='context'>
              <pre class='context'>      Open3.capture3(scp_command)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>144</pre>
            </td>
            <td class='context'>
              <pre class='context'>      server_params[:files_path] = server_path</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>145</pre>
            </td>
            <td class='context'>
              <pre class='context'>      output = ssh.exec!(&quot;#{server_command} run &#39;#{JSON.generate(server_params)}&#39;&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>146</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if output.exitstatus != 0</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>147</pre>
            </td>
            <td class='context'>
              <pre class='context'>        raise output</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>148</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>AutotestScriptsJob</td>
      <td>perform</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
      <td><div class='warning_message' onClick="toggle('context10');toggle('message10');toggle('full_message10')" ><span id='message10' style='display:block' >Possible command injection near line 25: Open3.capture2e(&quot;#{MarkusConfigurator.autotest_server_comman...</span><span id='full_message10' style='display:none'>Possible command injection near line 25: Open3.capture2e(&quot;#{<span class="user_input">MarkusConfigurator.autotest_server_command</span>} scripts &#39;#{JSON.generate(:markus_address =&gt; ((host_with_port or (host_with_port + Rails.application.config.action_controller.relative_url_root))), :files_path =&gt; Dir.mktmpdir(nil, MarkusConfigurator.autotest_server_dir), :assignment_id =&gt; assignment_id)}&#39;&quot;)</span><table id='context10' class='context' style='display:none'><caption>app/jobs/autotest_scripts_job.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>20</pre>
          </td>
          <td class='context'>
            <pre class='context'>      if server_username.nil?</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # files copied locally with no authentication</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>        server_path = Dir.mktmpdir(nil, server_path) # create temp subfolder</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>        FileUtils.cp_r(&quot;#{assignment_tests_path}/.&quot;, server_path) # includes hidden files</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>        server_params[:files_path] = server_path</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>        out, status = Open3.capture2e(&quot;#{server_command} scripts &#39;#{JSON.generate(server_params)}&#39;&quot;)</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if status.exitstatus != 0</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>          raise out</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>          # TODO: use out for something?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>EnsureConfigHelper</td>
      <td>s(:self).check_if_executes</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
      <td><div class='warning_message' onClick="toggle('context6');toggle('message6');toggle('full_message6')" >Possible command injection near line 109: IO.popen(&quot;\&quot;#{<span class="user_input">filename</span>}\&quot;&quot;, &quot;r+&quot;)<table id='context6' class='context' style='display:none'><caption>app/helpers/ensure_config_helper.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>104</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def self.check_if_executes(filename, constant_name)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>105</pre>
            </td>
            <td class='context'>
              <pre class='context'>    output = &#39;&#39;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>    executable = (File.exist?(filename)) ? File.stat(filename).executable? : false</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>108</pre>
            </td>
            <td class='context'>
              <pre class='context'>    if executable</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>109</pre>
            </td>
            <td class='context'>
              <pre class='context'>      IO.popen(&quot;\&quot;#{filename}\&quot;&quot;, &#39;r+&#39;) do |pipe|</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>110</pre>
            </td>
            <td class='context'>
              <pre class='context'>        pipe.puts(&quot;test\ntest&quot;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>111</pre>
            </td>
            <td class='context'>
              <pre class='context'>        pipe.close_write</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>113</pre>
            </td>
            <td class='context'>
              <pre class='context'>        output = pipe.read</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>114</pre>
            </td>
            <td class='context'>
              <pre class='context'>        pipe.close_read</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>User</td>
      <td>User.authenticate</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/command_injection/">Command Injection</a></td>
      <td><div class='warning_message' onClick="toggle('context5');toggle('message5');toggle('full_message5')" ><span id='message5' style='display:block' >Possible command injection near line 81: IO.popen(&quot;&#39;#{<span class="user_input">MarkusConfigurator.markus_config_validate_file</span>}...</span><span id='full_message5' style='display:none'>Possible command injection near line 81: IO.popen(&quot;&#39;#{<span class="user_input">MarkusConfigurator.markus_config_validate_file</span>}&#39;&quot;, &quot;w+&quot;)</span><table id='context5' class='context' style='display:none'><caption>app/models/user.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>76</pre>
          </td>
          <td class='context'>
            <pre class='context'>      # In general, the external password validation program will return the</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>77</pre>
            </td>
            <td class='context'>
              <pre class='context'>      # following codes (other than 0):</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>78</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #  1 means no such user</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>79</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #  2 means bad password</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>80</pre>
            </td>
            <td class='context'>
              <pre class='context'>      #  3 is used for other error exits</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>81</pre>
            </td>
            <td class='context'>
              <pre class='context'>      pipe = IO.popen(&quot;&#39;#{MarkusConfigurator.markus_config_validate_file}&#39;&quot;, &#39;w+&#39;) # quotes to avoid choking on spaces</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>82</pre>
            </td>
            <td class='context'>
              <pre class='context'>      pipe.puts(&quot;#{login}\n#{password}&quot;) # write to stdin of markus_config_validate</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>83</pre>
            </td>
            <td class='context'>
              <pre class='context'>      pipe.close</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>84</pre>
            </td>
            <td class='context'>
              <pre class='context'>      m_logger = MarkusLogger.instance</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>85</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if (defined? VALIDATE_CUSTOM_EXIT_STATUS) &amp;&amp; $?.exitstatus == VALIDATE_CUSTOM_EXIT_STATUS</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>86</pre>
            </td>
            <td class='context'>
              <pre class='context'>        m_logger.log(&quot;Login failed. Reason: Custom exit status.&quot;, MarkusLogger::ERROR)</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>GradeEntryFormsController</td>
      <td>update_grade</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross-site_scripting/">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context21');toggle('message21');toggle('full_message21')" ><span id='message21' style='display:block' >Unescaped model attribute rendered inline near line 98: render(text =&gt; GradeEntryForm.find(params[:id...</span><span id='full_message21' style='display:none'>Unescaped model attribute rendered inline near line 98: render(text =&gt; <span class="user_input">GradeEntryForm.find(params[:id]).grade_entry_students.find_or_create_by(:user_id =&gt; params[:student_id]).total_grade</span>, {})</span><table id='context21' class='context' style='display:none'><caption>app/controllers/grade_entry_forms_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>93</pre>
          </td>
          <td class='context'>
            <pre class='context'>      grade_entry_student.grades.find_or_create_by(grade_entry_item_id: params[:grade_entry_item_id])</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>    grade.update(grade: params[:updated_grade])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>    grade_entry_student.save # Refresh total grade</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>    grade_entry_student.reload</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>    render text: grade_entry_student.total_grade</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # For students</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def student_interface</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @grade_entry_form = GradeEntryForm.find(params[:id])</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>ResultsController</td>
      <td>update_mark</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross-site_scripting/">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context22');toggle('message22');toggle('full_message22')" ><span id='message22' style='display:block' >Unescaped model attribute rendered inline near line 440: render(text =&gt; Mark.find(params[:mark_id]).e...</span><span id='full_message22' style='display:none'>Unescaped model attribute rendered inline near line 440: render(text =&gt; <span class="user_input">Mark.find(params[:mark_id]).errors.full_messages.join</span>, { :status =&gt; :bad_request })</span><table id='context22' class='context' style='display:none'><caption>app/controllers/results_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>435</pre>
          </td>
          <td class='context'>
            <pre class='context'>                   &quot;User: #{current_user.user_name}, &quot; +</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>436</pre>
            </td>
            <td class='context'>
              <pre class='context'>                   &quot;Submission id: #{submission.id}, &quot; +</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>437</pre>
            </td>
            <td class='context'>
              <pre class='context'>                   &quot;Assignment: #{assignment.short_identifier}, &quot; +</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>438</pre>
            </td>
            <td class='context'>
              <pre class='context'>                   &quot;Group: #{group.group_name}.&quot;,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>439</pre>
            </td>
            <td class='context'>
              <pre class='context'>                   MarkusLogger::ERROR)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>440</pre>
            </td>
            <td class='context'>
              <pre class='context'>      render text: result_mark.errors.full_messages.join, status: :bad_request</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>441</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>442</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>444</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def view_marks</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>445</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @assignment = Assignment.find(params[:assignment_id])</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>Api::SubmissionDownloadsController</td>
      <td>index</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context23');toggle('message23');toggle('full_message23')" ><span id='message23' style='display:block' >Model attribute used in file name near line 92: send_file(&quot;tmp/#{&quot;#{Assignment.find_by_id(params[:ass...</span><span id='full_message23' style='display:none'>Model attribute used in file name near line 92: send_file(&quot;tmp/#{&quot;#{<span class="user_input">Assignment.find_by_id(params[:assignment_id])[:short_identifier]</span>}_#{Group.find_by_id(params[:group_id])[:group_name]}.zip&quot;}&quot;, :disposition =&gt; &quot;inline&quot;, :filename =&gt; (&quot;#{<span class="user_input">Assignment.find_by_id(params[:assignment_id])[:short_identifier]</span>}_#{Group.find_by_id(params[:group_id])[:group_name]}.zip&quot;))</span><table id='context23' class='context' style='display:none'><caption>app/controllers/api/submission_downloads_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>87</pre>
          </td>
          <td class='context'>
            <pre class='context'>        end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>90</pre>
            </td>
            <td class='context'>
              <pre class='context'>      # Send the zip</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if files.length &gt; 1</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>        send_file &quot;tmp/#{zip_name}&quot;, disposition: &#39;inline&#39;, filename:</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>          zip_name</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>94</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>97</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end # end SubmissionDownloadsController</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>SubmissionsController</td>
      <td>update_files</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context17');toggle('message17');toggle('full_message17')" ><span id='message17' style='display:block' >Model attribute used in file name near line 375: Pathname.new(Assignment.find(params[:assignment_id])...</span><span id='full_message17' style='display:none'>Model attribute used in file name near line 375: Pathname.new(<span class="user_input">Assignment.find(params[:assignment_id]).repository_folder</span>)</span><table id='context17' class='context' style='display:none'><caption>app/controllers/submissions_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>370</pre>
          </td>
          <td class='context'>
            <pre class='context'>          end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>371</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>372</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>373</pre>
            </td>
            <td class='context'>
              <pre class='context'>      @grouping.group.access_repo do |repo|</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>375</pre>
            </td>
            <td class='context'>
              <pre class='context'>        assignment_path = Pathname.new(@assignment.repository_folder)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>376</pre>
            </td>
            <td class='context'>
              <pre class='context'>        current_path = assignment_path.join(@path[1..-1]) # remove leading &#39;/&#39; to make relative path</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>378</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # Get the revision numbers for the files that we&#39;ve seen - these</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>379</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # values will be the &quot;expected revision numbers&quot; that we&#39;ll provide</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>380</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # to the transaction to ensure that we don&#39;t overwrite a file that&#39;s</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>SubmissionsController</td>
      <td>downloads</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context31');toggle('message31');toggle('full_message31')" ><span id='message31' style='display:block' >Model attribute used in file name near line 673: send_file(&quot;tmp/#{Assignment.find(params[:assignment_...</span><span id='full_message31' style='display:none'>Model attribute used in file name near line 673: send_file(&quot;tmp/#{<span class="user_input">Assignment.find(params[:assignment_id]).short_identifier</span>}_#{(current_user.accepted_grouping_for(Assignment.find(params[:assignment_id])) or Assignment.find(params[:assignment_id]).groupings.find(params[:grouping_id])).group.group_name}_#{(repo.get_latest_revision or repo.get_revision(params[:revision_identifier])).revision_identifier}.zip&quot;, :filename =&gt; (&quot;#{<span class="user_input">Assignment.find(params[:assignment_id]).short_identifier</span>}-#{(current_user.accepted_grouping_for(Assignment.find(params[:assignment_id])) or Assignment.find(params[:assignment_id]).groupings.find(params[:grouping_id])).group.group_name}&quot; + &quot;.zip&quot;))</span><table id='context31' class='context' style='display:none'><caption>app/controllers/submissions_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>668</pre>
          </td>
          <td class='context'>
            <pre class='context'>        downloads_subdirectories(&#39;&#39;,</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>669</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                 assignment.repository_folder,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>670</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                 zip_file, zip_name, repo, revision)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>671</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>673</pre>
            </td>
            <td class='context'>
              <pre class='context'>      send_file zip_path, filename: zip_name + &#39;.zip&#39;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>674</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>675</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>677</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # Given a subdirectory, its path, and an already created zip_file,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>678</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # fill the subdirectory within the zip_file with all of its files.</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>Grouping</td>
      <td>Grouping.update_criteria_coverage_counts</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
      <td><div class='warning_message' onClick="toggle('context33');toggle('message33');toggle('full_message33')" ><span id='message33' style='display:block' >Possible SQL injection near line 167: connection.execute(&quot;      UPDATE groupings AS g SET criteria_co...</span><span id='full_message33' style='display:none'>Possible SQL injection near line 167: connection.execute(&quot;      UPDATE groupings AS g SET criteria_coverage_count =\n        (SELECT count(DISTINCT c.criterion_id) FROM memberships AS m\n          INNER JOIN criterion_ta_associations AS c ON m.user_id = c.ta_id\n          WHERE m.grouping_id = g.id AND m.type = &#39;TaMembership&#39;\n            AND c.assignment_id = g.assignment_id)\n        WHERE assignment_id = #{assignment.id}\n          #{<span class="user_input">unless (Array(grouping_ids).map do  connection.quote(grouping_id)  end.join(&quot;,&quot;).empty?) then   &quot;AND id IN (#{Array(grouping_ids).map do    connection.quote(grouping_id)    end.join(&quot;,&quot;)})&quot; end</span>}\n&quot;)</span><table id='context33' class='context' style='display:none'><caption>app/models/grouping.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>162</pre>
          </td>
          <td class='context'>
            <pre class='context'>      UPDATE groupings AS g SET criteria_coverage_count =</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>163</pre>
            </td>
            <td class='context'>
              <pre class='context'>        (SELECT count(DISTINCT c.criterion_id) FROM memberships AS m</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>164</pre>
            </td>
            <td class='context'>
              <pre class='context'>          INNER JOIN criterion_ta_associations AS c ON m.user_id = c.ta_id</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>165</pre>
            </td>
            <td class='context'>
              <pre class='context'>          WHERE m.grouping_id = g.id AND m.type = &#39;TaMembership&#39;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>166</pre>
            </td>
            <td class='context'>
              <pre class='context'>            AND c.assignment_id = g.assignment_id)</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>167</pre>
            </td>
            <td class='context'>
              <pre class='context'>        WHERE assignment_id = #{assignment.id}</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>168</pre>
            </td>
            <td class='context'>
              <pre class='context'>          #{&quot;AND id IN (#{grouping_ids_str})&quot; unless grouping_ids_str.empty?}</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>169</pre>
            </td>
            <td class='context'>
              <pre class='context'>    UPDATE_SQL</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>170</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>172</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def get_all_students_in_group</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>AutomatedTestsController</td>
      <td>download</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context16');toggle('message16');toggle('full_message16')" ><span id='message16' style='display:block' >Model attribute used in file name near line 127: IO.read(File.expand_path(File.join(File.expand_path(...</span><span id='full_message16' style='display:none'>Model attribute used in file name near line 127: IO.read(File.expand_path(File.join(File.expand_path(File.join(AutomatedTestsClientHelper::ASSIGNMENTS_DIR, Assignment.find(params[:assignment_id]).short_identifier)), <span class="user_input">(TestScript or TestSupportFile).find_by(:assignment_id =&gt; params[:assignment_id], :file_name =&gt; params[:filename])</span>.file_name)))</span><table id='context16' class='context' style='display:none'><caption>app/controllers/automated_tests_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>122</pre>
          </td>
          <td class='context'>
            <pre class='context'>      should_be_in = File.expand_path(should_be_in)</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>123</pre>
            </td>
            <td class='context'>
              <pre class='context'>      filename = File.expand_path(File.join(should_be_in, filename))</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if should_be_in == File.dirname(filename) and File.readable?(filename)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # Everything looks OK. Send the file over to the client.</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>        file_contents = IO.read(filename)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>        send_file filename,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  type: ( SubmissionFile.is_binary?(file_contents) ? &#39;application/octet-stream&#39;:&#39;text/plain&#39; ),</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  x_sendfile: true</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # print flash error messages</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>AutomatedTestsController</td>
      <td>download</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context24');toggle('message24');toggle('full_message24')" ><span id='message24' style='display:block' >Model attribute used in file name near line 128: send_file(File.expand_path(File.join(File.expand_pat...</span><span id='full_message24' style='display:none'>Model attribute used in file name near line 128: send_file(File.expand_path(File.join(File.expand_path(File.join(AutomatedTestsClientHelper::ASSIGNMENTS_DIR, Assignment.find(params[:assignment_id]).short_identifier)), <span class="user_input">(TestScript or TestSupportFile).find_by(:assignment_id =&gt; params[:assignment_id], :file_name =&gt; params[:filename])</span>.file_name)), :type =&gt; (if SubmissionFile.is_binary?(IO.read(File.expand_path(File.join(File.expand_path(File.join(AutomatedTestsClientHelper::ASSIGNMENTS_DIR, Assignment.find(params[:assignment_id]).short_identifier)), <span class="user_input">(TestScript or TestSupportFile).find_by(:assignment_id =&gt; params[:assignment_id], :file_name =&gt; params[:filename])</span>.file_name)))) then   &quot;application/octet-stream&quot; else   &quot;text/plain&quot; end), :x_sendfile =&gt; true)</span><table id='context24' class='context' style='display:none'><caption>app/controllers/automated_tests_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>123</pre>
          </td>
          <td class='context'>
            <pre class='context'>      filename = File.expand_path(File.join(should_be_in, filename))</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if should_be_in == File.dirname(filename) and File.readable?(filename)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # Everything looks OK. Send the file over to the client.</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>        file_contents = IO.read(filename)</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>        send_file filename,</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  type: ( SubmissionFile.is_binary?(file_contents) ? &#39;application/octet-stream&#39;:&#39;text/plain&#39; ),</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>                  x_sendfile: true</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # print flash error messages</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>      else</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>AutotestScriptsJob</td>
      <td>perform</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context20');toggle('message20');toggle('full_message20')" ><span id='message20' style='display:block' >Model attribute used in file name near line 23: FileUtils.cp_r(&quot;#{File.join(AutomatedTestsClientHelpe...</span><span id='full_message20' style='display:none'>Model attribute used in file name near line 23: FileUtils.cp_r(&quot;#{File.join(AutomatedTestsClientHelper::ASSIGNMENTS_DIR, <span class="user_input">Assignment.find(assignment_id).short_identifier</span>)}/.&quot;, Dir.mktmpdir(nil, MarkusConfigurator.autotest_server_dir))</span><table id='context20' class='context' style='display:none'><caption>app/jobs/autotest_scripts_job.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>19</pre>
          </td>
          <td class='context'>
            <pre class='context'>    begin</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>      if server_username.nil?</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>        # files copied locally with no authentication</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>        server_path = Dir.mktmpdir(nil, server_path) # create temp subfolder</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>        FileUtils.cp_r(&quot;#{assignment_tests_path}/.&quot;, server_path) # includes hidden files</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>        server_params[:files_path] = server_path</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>        out, status = Open3.capture2e(&quot;#{server_command} scripts &#39;#{JSON.generate(server_params)}&#39;&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>        if status.exitstatus != 0</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>          raise out</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>        else</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>ExamTemplate</td>
      <td>ExamTemplate.create_with_file</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context13');toggle('message13');toggle('full_message13')" ><span id='message13' style='display:block' >Model attribute used in file name near line 35: File.open(File.join(File.join(MarkusConfigurator.mark...</span><span id='full_message13' style='display:none'>Model attribute used in file name near line 35: File.open(File.join(File.join(MarkusConfigurator.markus_exam_template_dir, <span class="user_input">Assignment.find(attributes[:assignment_id]).short_identifier</span>, (File.basename(attributes[:filename].tr(&quot; &quot;, &quot;_&quot;), &quot;.pdf&quot;) or attributes[:name])), attributes[:filename]), &quot;wb&quot;)</span><table id='context13' class='context' style='display:none'><caption>app/models/exam_template.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>30</pre>
          </td>
          <td class='context'>
            <pre class='context'>      assignment_name,</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>      exam_template_name</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>    )</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>    FileUtils.mkdir_p template_path unless Dir.exists? template_path</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>    File.open(File.join(template_path, attributes[:filename]), &#39;wb&#39;) do |f|</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>      f.write blob</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>39</pre>
            </td>
            <td class='context'>
              <pre class='context'>    pdf = CombinePDF.parse blob</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>    attributes[:num_pages] = pdf.pages.length</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>ExamTemplate</td>
      <td>ExamTemplate.new_with_file</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context14');toggle('message14');toggle('full_message14')" ><span id='message14' style='display:block' >Model attribute used in file name near line 59: File.open(File.join(File.join(MarkusConfigurator.mark...</span><span id='full_message14' style='display:none'>Model attribute used in file name near line 59: File.open(File.join(File.join(MarkusConfigurator.markus_exam_template_dir, <span class="user_input">Assignment.find(attributes[:assignment_id]).short_identifier</span>, (File.basename(attributes[:filename].tr(&quot; &quot;, &quot;_&quot;), &quot;.pdf&quot;) or attributes[:name])), attributes[:filename].tr(&quot; &quot;, &quot;_&quot;)), &quot;wb&quot;)</span><table id='context14' class='context' style='display:none'><caption>app/models/exam_template.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>54</pre>
          </td>
          <td class='context'>
            <pre class='context'>      MarkusConfigurator.markus_exam_template_dir,</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>      assignment_name,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>      exam_template_name</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>    )</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    FileUtils.mkdir_p template_path unless Dir.exists? template_path</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    File.open(File.join(template_path, filename), &#39;wb&#39;) do |f|</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>      f.write blob</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    pdf = CombinePDF.parse blob</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    num_pages = pdf.pages.length</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>    unless name_input == &#39;&#39;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>ExamTemplate</td>
      <td>replace_with_file</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context15');toggle('message15');toggle('full_message15')" ><span id='message15' style='display:block' >Model attribute used in file name near line 91: File.open(File.join(File.join(MarkusConfigurator.mark...</span><span id='full_message15' style='display:none'>Model attribute used in file name near line 91: File.open(File.join(File.join(MarkusConfigurator.markus_exam_template_dir, <span class="user_input">Assignment.find(attributes[:assignment_id]).short_identifier</span>, self.name), attributes[:new_filename].tr(&quot; &quot;, &quot;_&quot;)), &quot;wb&quot;)</span><table id='context15' class='context' style='display:none'><caption>app/models/exam_template.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>86</pre>
          </td>
          <td class='context'>
            <pre class='context'>      MarkusConfigurator.markus_exam_template_dir,</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>87</pre>
            </td>
            <td class='context'>
              <pre class='context'>      assignment_name,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>88</pre>
            </td>
            <td class='context'>
              <pre class='context'>      self.name</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>89</pre>
            </td>
            <td class='context'>
              <pre class='context'>    )</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>91</pre>
            </td>
            <td class='context'>
              <pre class='context'>    File.open(File.join(template_path, attributes[:new_filename].tr(&#39; &#39;, &#39;_&#39;)), &#39;wb&#39;) do |f|</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>92</pre>
            </td>
            <td class='context'>
              <pre class='context'>      f.write blob</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>93</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>95</pre>
            </td>
            <td class='context'>
              <pre class='context'>    pdf = CombinePDF.parse blob</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>96</pre>
            </td>
            <td class='context'>
              <pre class='context'>    self.update(num_pages: pdf.pages.length, filename: attributes[:new_filename])</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>ExamTemplate</td>
      <td>ExamTemplate.create_with_file</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context18');toggle('message18');toggle('full_message18')" ><span id='message18' style='display:block' >Model attribute used in file name near line 33: FileUtils.mkdir_p(File.join(MarkusConfigurator.markus...</span><span id='full_message18' style='display:none'>Model attribute used in file name near line 33: FileUtils.mkdir_p(File.join(MarkusConfigurator.markus_exam_template_dir, <span class="user_input">Assignment.find(attributes[:assignment_id]).short_identifier</span>, (File.basename(attributes[:filename].tr(&quot; &quot;, &quot;_&quot;), &quot;.pdf&quot;) or attributes[:name])))</span><table id='context18' class='context' style='display:none'><caption>app/models/exam_template.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>28</pre>
          </td>
          <td class='context'>
            <pre class='context'>    template_path = File.join(</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>      MarkusConfigurator.markus_exam_template_dir,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>      assignment_name,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>      exam_template_name</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>    )</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>    FileUtils.mkdir_p template_path unless Dir.exists? template_path</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>    File.open(File.join(template_path, attributes[:filename]), &#39;wb&#39;) do |f|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>      f.write blob</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>ExamTemplate</td>
      <td>ExamTemplate.new_with_file</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context19');toggle('message19');toggle('full_message19')" ><span id='message19' style='display:block' >Model attribute used in file name near line 58: FileUtils.mkdir_p(File.join(MarkusConfigurator.markus...</span><span id='full_message19' style='display:none'>Model attribute used in file name near line 58: FileUtils.mkdir_p(File.join(MarkusConfigurator.markus_exam_template_dir, <span class="user_input">Assignment.find(attributes[:assignment_id]).short_identifier</span>, (File.basename(attributes[:filename].tr(&quot; &quot;, &quot;_&quot;), &quot;.pdf&quot;) or attributes[:name])))</span><table id='context19' class='context' style='display:none'><caption>app/models/exam_template.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>53</pre>
          </td>
          <td class='context'>
            <pre class='context'>    template_path = File.join(</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>54</pre>
            </td>
            <td class='context'>
              <pre class='context'>      MarkusConfigurator.markus_exam_template_dir,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>55</pre>
            </td>
            <td class='context'>
              <pre class='context'>      assignment_name,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>56</pre>
            </td>
            <td class='context'>
              <pre class='context'>      exam_template_name</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>57</pre>
            </td>
            <td class='context'>
              <pre class='context'>    )</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>58</pre>
            </td>
            <td class='context'>
              <pre class='context'>    FileUtils.mkdir_p template_path unless Dir.exists? template_path</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>59</pre>
            </td>
            <td class='context'>
              <pre class='context'>    File.open(File.join(template_path, filename), &#39;wb&#39;) do |f|</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>      f.write blob</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>    pdf = CombinePDF.parse blob</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>    num_pages = pdf.pages.length</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>ExamTemplatesController</td>
      <td>download</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context25');toggle('message25');toggle('full_message25')" ><span id='message25' style='display:block' >Parameter value used in file name near line 43: send_file(File.join(Assignment.find(params[:assignmen...</span><span id='full_message25' style='display:none'>Parameter value used in file name near line 43: send_file(File.join(Assignment.find(params[:assignment_id]).exam_templates.find_by(:id =&gt; <span class="user_input">params[:id]</span>).base_path, Assignment.find(params[:assignment_id]).exam_templates.find_by(:id =&gt; <span class="user_input">params[:id]</span>).filename), :filename =&gt; (&quot;#{Assignment.find(params[:assignment_id]).exam_templates.find_by(:id =&gt; <span class="user_input">params[:id]</span>).filename}&quot;), :type =&gt; &quot;application/pdf&quot;)</span><table id='context25' class='context' style='display:none'><caption>app/controllers/exam_templates_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>39</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def download</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>40</pre>
            </td>
            <td class='context'>
              <pre class='context'>    assignment = Assignment.find(params[:assignment_id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>41</pre>
            </td>
            <td class='context'>
              <pre class='context'>    exam_template = assignment.exam_templates.find_by(id: params[:id]) # look up a specific exam template based on the params[:id]</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>42</pre>
            </td>
            <td class='context'>
              <pre class='context'>    filename = exam_template.filename</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>43</pre>
            </td>
            <td class='context'>
              <pre class='context'>    send_file(File.join(exam_template.base_path, filename),</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>44</pre>
            </td>
            <td class='context'>
              <pre class='context'>              filename: &quot;#{filename}&quot;,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>45</pre>
            </td>
            <td class='context'>
              <pre class='context'>              type: &quot;application/pdf&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>46</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>48</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def update</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>ExamTemplatesController</td>
      <td>download_generate</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context26');toggle('message26');toggle('full_message26')" ><span id='message26' style='display:block' >Parameter value used in file name near line 101: send_file(File.join(Assignment.find(params[:assignme...</span><span id='full_message26' style='display:none'>Parameter value used in file name near line 101: send_file(File.join(Assignment.find(params[:assignment_id]).exam_templates.find(params[:id]).base_path, <span class="user_input">params[:file_name]</span>), :filename =&gt; <span class="user_input">params[:file_name]</span>, :type =&gt; &quot;application/pdf&quot;)</span><table id='context26' class='context' style='display:none'><caption>app/controllers/exam_templates_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>96</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>98</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def download_generate</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>99</pre>
            </td>
            <td class='context'>
              <pre class='context'>    assignment = Assignment.find(params[:assignment_id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>100</pre>
            </td>
            <td class='context'>
              <pre class='context'>    exam_template = assignment.exam_templates.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>101</pre>
            </td>
            <td class='context'>
              <pre class='context'>    send_file(File.join(exam_template.base_path, params[:file_name]),</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>102</pre>
            </td>
            <td class='context'>
              <pre class='context'>              filename: params[:file_name],</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>103</pre>
            </td>
            <td class='context'>
              <pre class='context'>              type: &quot;application/pdf&quot;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>104</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>106</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def split</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>ExamTemplatesController</td>
      <td>download_raw_split_file</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context27');toggle('message27');toggle('full_message27')" ><span id='message27' style='display:block' >Parameter value used in file name near line 220: send_file(File.join(Assignment.find(params[:assignme...</span><span id='full_message27' style='display:none'>Parameter value used in file name near line 220: send_file(File.join(Assignment.find(params[:assignment_id]).exam_templates.find(params[:id]).base_path, &quot;raw&quot;, &quot;raw_upload_#{Assignment.find(params[:assignment_id]).exam_templates.find(params[:id]).split_pdf_logs.find(<span class="user_input">params[:split_pdf_log_id]</span>).id}.pdf&quot;), :filename =&gt; Assignment.find(params[:assignment_id]).exam_templates.find(params[:id]).split_pdf_logs.find(<span class="user_input">params[:split_pdf_log_id]</span>).filename, :type =&gt; &quot;application/pdf&quot;)</span><table id='context27' class='context' style='display:none'><caption>app/controllers/exam_templates_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>215</pre>
          </td>
          <td class='context'>
            <pre class='context'>  def download_raw_split_file</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>216</pre>
            </td>
            <td class='context'>
              <pre class='context'>    assignment = Assignment.find(params[:assignment_id])</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>217</pre>
            </td>
            <td class='context'>
              <pre class='context'>    exam_template = assignment.exam_templates.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>218</pre>
            </td>
            <td class='context'>
              <pre class='context'>    split_pdf_log = exam_template.split_pdf_logs.find(params[:split_pdf_log_id])</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>219</pre>
            </td>
            <td class='context'>
              <pre class='context'>    split_file = &quot;raw_upload_#{split_pdf_log.id}.pdf&quot;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>220</pre>
            </td>
            <td class='context'>
              <pre class='context'>    send_file(File.join(exam_template.base_path, &#39;raw&#39;, split_file),</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>221</pre>
            </td>
            <td class='context'>
              <pre class='context'>              filename: split_pdf_log.filename,</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>222</pre>
            </td>
            <td class='context'>
              <pre class='context'>              type: &#39;application/pdf&#39;)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>223</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>225</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def download_error_file</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>ExamTemplatesController</td>
      <td>download_error_file</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context28');toggle('message28');toggle('full_message28')" ><span id='message28' style='display:block' >Parameter value used in file name near line 228: send_file(File.join(Assignment.find(params[:assignme...</span><span id='full_message28' style='display:none'>Parameter value used in file name near line 228: send_file(File.join(Assignment.find(params[:assignment_id]).exam_templates.find(params[:id]).base_path, &quot;error&quot;, <span class="user_input">params[:file_name]</span>), :filename =&gt; <span class="user_input">params[:file_name]</span>, :type =&gt; &quot;application/pdf&quot;)</span><table id='context28' class='context' style='display:none'><caption>app/controllers/exam_templates_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>223</pre>
          </td>
          <td class='context'>
            <pre class='context'>  end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>225</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def download_error_file</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>226</pre>
            </td>
            <td class='context'>
              <pre class='context'>    @assignment = Assignment.find(params[:assignment_id])</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>227</pre>
            </td>
            <td class='context'>
              <pre class='context'>    exam_template = @assignment.exam_templates.find(params[:id])</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>228</pre>
            </td>
            <td class='context'>
              <pre class='context'>    send_file(File.join(exam_template.base_path, &#39;error&#39;, params[:file_name]),</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>229</pre>
            </td>
            <td class='context'>
              <pre class='context'>              filename: params[:file_name],</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>230</pre>
            </td>
            <td class='context'>
              <pre class='context'>              type: &#39;application/pdf&#39;)</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>231</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>233</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def fix_error</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>ResultsController</td>
      <td>download_zip</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/file_access/">File Access</a></td>
      <td><div class='warning_message' onClick="toggle('context29');toggle('message29');toggle('full_message29')" ><span id='message29' style='display:block' >Model attribute used in file name near line 376: send_file(((&quot;tmp/#{Assignment.find(params[:assignmen...</span><span id='full_message29' style='display:none'>Model attribute used in file name near line 376: send_file(((&quot;tmp/#{Assignment.find(params[:assignment_id]).short_identifier}_&quot; + &quot;#{Grouping.find(Submission.find(params[:submission_id]).grouping_id).group.group_name}_r#{<span class="user_input">Submission.find(params[:submission_id]).revision_identifier</span>}_ann.zip&quot;) or (&quot;tmp/#{Assignment.find(params[:assignment_id]).short_identifier}_&quot; + &quot;#{Grouping.find(Submission.find(params[:submission_id]).grouping_id).group.group_name}_r#{<span class="user_input">Submission.find(params[:submission_id]).revision_identifier</span>}.zip&quot;)), :disposition =&gt; &quot;inline&quot;, :filename =&gt; (&quot;#{Assignment.find(params[:assignment_id]).repository_folder}-#{Grouping.find(Submission.find(params[:submission_id]).grouping_id).group.repo_name}&quot; + &quot;.zip&quot;))</span><table id='context29' class='context' style='display:none'><caption>app/controllers/results_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>371</pre>
          </td>
          <td class='context'>
            <pre class='context'>          f.puts file_content</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>372</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>373</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>374</pre>
            </td>
            <td class='context'>
              <pre class='context'>    end</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>375</pre>
            </td>
            <td class='context'>
              <pre class='context'>    # Send the Zip file</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>376</pre>
            </td>
            <td class='context'>
              <pre class='context'>    send_file zip_path, disposition: &#39;inline&#39;,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>377</pre>
            </td>
            <td class='context'>
              <pre class='context'>              filename: zip_name + &#39;.zip&#39;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>378</pre>
            </td>
            <td class='context'>
              <pre class='context'>  end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>380</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def get_annotations</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>381</pre>
            </td>
            <td class='context'>
              <pre class='context'>    result = Result.find(params[:id])</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>Api::MainApiController</td>
      <td>get_collection</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/sql_injection/">SQL Injection</a></td>
      <td><div class='warning_message' onClick="toggle('context32');toggle('message32');toggle('full_message32')" ><span id='message32' style='display:block' >Possible SQL injection near line 131: (collection.order(&quot;id&quot;) or collection_class.order(&quot;id&quot;)).where(...</span><span id='full_message32' style='display:none'>Possible SQL injection near line 131: (collection.order(&quot;id&quot;) or collection_class.order(&quot;id&quot;)).where(&quot;? = ?&quot;, <span class="user_input">key.to_sym</span>, value).where(&quot;lower(#{<span class="user_input">key.to_sym</span>}) = ?&quot;, value.downcase)</span><table id='context32' class='context' style='display:none'><caption>app/controllers/api/main_api_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>126</pre>
          </td>
          <td class='context'>
            <pre class='context'>                end</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>              end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>              # Do a case-insensitive search if dealing with strings</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>130</pre>
            </td>
            <td class='context'>
              <pre class='context'>              unless numericality</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>                collection = collection.where(&quot;lower(#{key}) = ?&quot;, value.downcase)</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>              end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>133</pre>
            </td>
            <td class='context'>
              <pre class='context'>            end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>134</pre>
            </td>
            <td class='context'>
              <pre class='context'>          end</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>135</pre>
            </td>
            <td class='context'>
              <pre class='context'>        end</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>136</pre>
            </td>
            <td class='context'>
              <pre class='context'>      end</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
  </tbody>
</table>
<p>Controller Warnings</p>
<table>
  <thead>
    <tr>
      <th>Confidence</th>
      <th>Controller</th>
      <th>Warning Type</th>
      <th>Message</th>
    </tr>
  </thead>
  <tbody>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>Api::MainApiController</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross-site_request_forgery/">Cross-Site Request Forgery</a></td>
      <td><div class='warning_message' onClick="toggle('context40');toggle('message40');toggle('full_message40')" >&#39;protect_from_forgery&#39; should be called in Api::MainApiController near line 6<table id='context40' class='context' style='display:none'><caption>app/controllers/api/main_api_controller.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'># Scripting API handlers for MarkUs</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>module Api</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # This is the parent class of all API controllers. Shared functionality of</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # all API controllers should go here.</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>  class MainApiController &lt; ActionController::Base</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>    include Pundit</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>    attr_reader :current_user</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>    before_filter :check_format, :authenticate</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
  </tbody>
</table><p>Model Warnings</p>
<table>
  <thead>
    <tr>
      <th>Confidence</th>
      <th>Model</th>
      <th>Warning Type</th>
      <th>Message</th>
    </tr>
  </thead>
  <tbody>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>Annotation</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/format_validation/">Format Validation</a></td>
      <td><div class='warning_message' onClick="toggle('context41');toggle('message41');toggle('full_message41')" ><span id='message41' style='display:block' >Insufficient validation for &#39;type&#39; using /ImageAnnotation|TextAnnotation|PdfAnnotation/. Use \A and \...</span><span id='full_message41' style='display:none'>Insufficient validation for &#39;type&#39; using /ImageAnnotation|TextAnnotation|PdfAnnotation/. Use \A and \z as anchors near line 33</span><table id='context41' class='context' style='display:none'><caption>app/models/annotation.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>28</pre>
          </td>
          <td class='context'>
            <pre class='context'>  validates_numericality_of :result_id,</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            only_integer: true,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>                            greater_than: 0</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_format_of :type,</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>                      with: /ImageAnnotation|TextAnnotation|PdfAnnotation/</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>  def get_data(include_creator=false)</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>    data = {</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>37</pre>
            </td>
            <td class='context'>
              <pre class='context'>      id: id,</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>      file: File.join(submission_file.path,</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>ExtraMark</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/format_validation/">Format Validation</a></td>
      <td><div class='warning_message' onClick="toggle('context42');toggle('message42');toggle('full_message42')" >Insufficient validation for &#39;unit&#39; using /percentage|points/. Use \A and \z as anchors near line 15<table id='context42' class='context' style='display:none'><caption>app/models/extra_mark.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>11</pre>
          </td>
          <td class='context'>
            <pre class='context'>  scope :percentage, -&gt; { where(unit: ExtraMark::PERCENTAGE) }</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>  scope :points,     -&gt; { where(unit: ExtraMark::POINTS)     }</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_presence_of :unit</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_format_of   :unit, with: /percentage|points/</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>  scope :positive, -&gt; { where(&#39;extra_mark &gt; 0&#39;) }</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>  scope :negative, -&gt; { where(&#39;extra_mark &lt; 0&#39;) }</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_numericality_of :extra_mark, message: &#39;Mark must be an number&#39;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>StudentMembership</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/format_validation/">Format Validation</a></td>
      <td><div class='warning_message' onClick="toggle('context43');toggle('message43');toggle('full_message43')" ><span id='message43' style='display:block' >Insufficient validation for &#39;membership_status&#39; using /inviter|pending|accepted|rejected/. Use \A and...</span><span id='full_message43' style='display:none'>Insufficient validation for &#39;membership_status&#39; using /inviter|pending|accepted|rejected/. Use \A and \z as anchors near line 25</span><table id='context43' class='context' style='display:none'><caption>app/models/student_membership.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>21</pre>
          </td>
          <td class='context'>
            <pre class='context'>  validate :must_be_valid_student</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_presence_of :membership_status</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_format_of :membership_status,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>                      with: /inviter|pending|accepted|rejected/</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>  before_update :update_repo_permissions_before_update</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>  before_create :update_repo_permissions_before_create</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>  before_destroy :update_repo_permissions_before_destroy</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='high-confidence'>High</span></td>
      <td>User</td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/format_validation/">Format Validation</a></td>
      <td><div class='warning_message' onClick="toggle('context44');toggle('message44');toggle('full_message44')" ><span id='message44' style='display:block' >Insufficient validation for &#39;type&#39; using /Student|Admin|Ta|TestServer/. Use \A and \z as anchors near...</span><span id='full_message44' style='display:none'>Insufficient validation for &#39;type&#39; using /Student|Admin|Ta|TestServer/. Use \A and \z as anchors near line 30</span><table id='context44' class='context' style='display:none'><caption>app/models/user.rb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>25</pre>
          </td>
          <td class='context'>
            <pre class='context'>  validates_presence_of     :user_name, :last_name, :first_name</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_uniqueness_of   :user_name</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_uniqueness_of   :email, :allow_nil =&gt; true</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_uniqueness_of   :id_number, :allow_nil =&gt; true</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>  validates_format_of       :type,          with: /Student|Admin|Ta|TestServer/</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>  # role constants</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>  STUDENT = &#39;Student&#39;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>  ADMIN = &#39;Admin&#39;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>  TA = &#39;Ta&#39;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>  TEST_SERVER = &#39;TestServer&#39;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
  </tbody>
</table><p>View Warnings</p>
<table>
  <thead>
    <tr>
      <th>Confidence</th>
      <th>Template</th>
      <th>Warning Type</th>
      <th>Message</th>
    </tr>
  </thead>
  <tbody>
  
    <tr>
      <td><span class='med-confidence'>Medium</span></td>
      <td>
        
          criteria/edit (CriteriaController#edit)
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/dynamic_render_path/">Dynamic Render Path</a></td>
      <td><div class='warning_message' onClick="toggle('context56');toggle('message56');toggle('full_message56')" ><span id='message56' style='display:block' >Render path contains parameter value near line 2: render(partial =&gt; &quot;#{params[:criterion_type].consta...</span><span id='full_message56' style='display:none'>Render path contains parameter value near line 2: render(partial =&gt; &quot;#{<span class="user_input">params[:criterion_type].constantize.find(params[:id]).class.to_s.tableize</span>}/criterion_editor&quot;, { :locals =&gt; ({ :criterion =&gt; params[:criterion_type].constantize.find(params[:id]) }) })</span><table id='context56' class='context' style='display:none'><caption>app/views/criteria/edit.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first near_error'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>document.getElementById(&#39;editing_pane_menu&#39;).innerHTML =</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>2</pre>
            </td>
            <td class='context'>
              <pre class='context'>  &quot;&lt;%= escape_javascript(render partial: &quot;#{@criterion.class.to_s.tableize}/criterion_editor&quot;,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                locals: { criterion: @criterion }) %&gt;&quot;;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          <div class="template_name" onClick="toggle('callers1')" >
            <div>
              assignments/_read (Template:assignments/student_interface)
            </div>
            <div class="render_path" id="callers1" >
              AssignmentsController#student_interface &rarr; Template:assignments/student_interface &rarr; assignments/_read
            </div>
          </div>
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context45');toggle('message45');toggle('full_message45')" ><span id='message45' style='display:block' >Unescaped model attribute near line 64: t(&quot;student.group_credits&quot;, :available_grace_credits =&gt; curren...</span><span id='full_message45' style='display:none'>Unescaped model attribute near line 64: t(&quot;student.group_credits&quot;, :available_grace_credits =&gt; <span class="user_input">current_user.accepted_grouping_for((Assignment.find(params[:id]).parent_assignment or Assignment.find(params[:id])).id).available_grace_credits</span>)</span><table id='context45' class='context' style='display:none'><caption>app/views/assignments/_read.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>59</pre>
          </td>
          <td class='context'>
            <pre class='context'>        &lt;span class=&#39;prop_label&#39;&gt;&lt;%= t(&#39;additional_information&#39;) %&gt;&lt;/span&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>60</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;% if @penalty.type == &quot;GracePeriodSubmissionRule&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>61</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;% if !@grouping.nil? %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>62</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= raw(t(&#39;student.group_credits&#39;,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>63</pre>
            </td>
            <td class='context'>
              <pre class='context'>                          available_grace_credits:</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>64</pre>
            </td>
            <td class='context'>
              <pre class='context'>                          @grouping.available_grace_credits)) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>65</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>66</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;% elsif @penalty.type == &quot;PenaltyDecayPeriodSubmissionRule&quot; %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>67</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;br&gt;&lt;ul&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>68</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;% @enum_penalty.each do |p| %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>69</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;% if p == @enum_penalty.first %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          assignments/student_interface (AssignmentsController#student_interface)
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context46');toggle('message46');toggle('full_message46')" ><span id='message46' style='display:block' >Unescaped model attribute near line 127: t(&quot;student.form_group&quot;, :group_min =&gt; (Assignment.find(param...</span><span id='full_message46' style='display:none'>Unescaped model attribute near line 127: t(&quot;student.form_group&quot;, :group_min =&gt; (<span class="user_input">Assignment.find(params[:id]).parent_assignment</span> or Assignment.find(params[:id])).group_min, :group_max =&gt; (<span class="user_input">Assignment.find(params[:id]).parent_assignment</span> or Assignment.find(params[:id])).group_max)</span><table id='context46' class='context' style='display:none'><caption>app/views/assignments/student_interface.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>122</pre>
          </td>
          <td class='context'>
            <pre class='context'>             # render UI elements for group creation</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>123</pre>
            </td>
            <td class='context'>
              <pre class='context'>             if !@assignment.past_collection_date?(@student.section) &amp;&amp; @assignment.student_form_groups %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>125</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;h3&gt;&lt;%= t(&#39;student.form_own_group&#39;) %&gt;&lt;/h3&gt;</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>126</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;p&gt;&lt;%= raw(t(&#39;student.form_group&#39;,</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>127</pre>
            </td>
            <td class='context'>
              <pre class='context'>                         group_min: @assignment.group_min,</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>128</pre>
            </td>
            <td class='context'>
              <pre class='context'>                         group_max: @assignment.group_max)) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>129</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/p&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>131</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;% if @assignment.group_min == 1 %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>132</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;p&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          assignments/student_interface (AssignmentsController#student_interface)
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context47');toggle('message47');toggle('full_message47')" ><span id='message47' style='display:block' >Unescaped model attribute near line 271: t(&quot;student.form_group&quot;, :group_min =&gt; (Assignment.find(param...</span><span id='full_message47' style='display:none'>Unescaped model attribute near line 271: t(&quot;student.form_group&quot;, :group_min =&gt; (<span class="user_input">Assignment.find(params[:id]).parent_assignment</span> or Assignment.find(params[:id])).group_min, :group_max =&gt; (<span class="user_input">Assignment.find(params[:id]).parent_assignment</span> or Assignment.find(params[:id])).group_max)</span><table id='context47' class='context' style='display:none'><caption>app/views/assignments/student_interface.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>266</pre>
          </td>
          <td class='context'>
            <pre class='context'>                !@assignment.invalid_override &amp;&amp;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>267</pre>
            </td>
            <td class='context'>
              <pre class='context'>                @assignment.group_max &gt; 1 %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>268</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;li&gt;&lt;%= t(&#39;student.students_can_form_groups&#39;) %&gt;&lt;/li&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>269</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;li&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>270</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= raw( t(&#39;student.form_group&#39;,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>271</pre>
            </td>
            <td class='context'>
              <pre class='context'>                        group_min: @assignment.group_min,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>272</pre>
            </td>
            <td class='context'>
              <pre class='context'>                        group_max: @assignment.group_max)) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>273</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;/li&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>274</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;% elsif @assignment.invalid_override %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>275</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;li&gt;&lt;%= t(&#39;student.invalid_override&#39;) %&gt;&lt;/li&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>276</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;% else %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          automated_tests/student_interface (AutomatedTestsController#student_interface)
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context48');toggle('message48');toggle('full_message48')" ><span id='message48' style='display:block' >Unescaped model attribute near line 14: t(&quot;automated_tests.token.token_start_date&quot;, :date =&gt; l(Assign...</span><span id='full_message48' style='display:none'>Unescaped model attribute near line 14: t(&quot;automated_tests.token.token_start_date&quot;, :date =&gt; l(<span class="user_input">Assignment.find(params[:id]).token_start_date</span>))</span><table id='context48' class='context' style='display:none'><caption>app/views/automated_tests/student_interface.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>9</pre>
          </td>
          <td class='context'>
            <pre class='context'>    &lt;div class=&#39;block_content&#39;&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;h3&gt;&lt;%= t(&#39;automated_tests.information&#39;) %&gt;&lt;/h3&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>11</pre>
            </td>
            <td class='context'>
              <pre class='context'>      &lt;div class=&#39;sub_block&#39;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>12</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;div class=&#39;sub_block&#39;&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>13</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;%= raw t(&#39;automated_tests.token.token_start_date&#39;,</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>14</pre>
            </td>
            <td class='context'>
              <pre class='context'>                    date: l(@assignment.token_start_date)) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>15</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>16</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;% if @assignment.unlimited_tokens %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>17</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;div class=&#39;sub_block&#39;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>18</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;%= raw t(&#39;automated_tests.token.unlimited_tokens&#39;) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/div&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          automated_tests/student_interface (AutomatedTestsController#student_interface)
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context49');toggle('message49');toggle('full_message49')" ><span id='message49' style='display:block' >Unescaped model attribute near line 23: t(&quot;automated_tests.token.tokens_per_period&quot;, :tokens =&gt; Assig...</span><span id='full_message49' style='display:none'>Unescaped model attribute near line 23: t(&quot;automated_tests.token.tokens_per_period&quot;, :tokens =&gt; <span class="user_input">Assignment.find(params[:id]).tokens_per_period</span>, :regeneration_period =&gt; Assignment.find(params[:id]).token_period)</span><table id='context49' class='context' style='display:none'><caption>app/views/automated_tests/student_interface.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>18</pre>
          </td>
          <td class='context'>
            <pre class='context'>            &lt;%= raw t(&#39;automated_tests.token.unlimited_tokens&#39;) %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>19</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>20</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>21</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;% unless @assignment.non_regenerating_tokens %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>22</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;div class=&#39;sub_block&#39;&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>23</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;%= raw t(&#39;automated_tests.token.tokens_per_period&#39;, tokens: @assignment.tokens_per_period,</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>24</pre>
            </td>
            <td class='context'>
              <pre class='context'>                      regeneration_period: @assignment.token_period) %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>25</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>26</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>27</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;div class=&#39;sub_block&#39;&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>28</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;% if DateTime.now &lt; @assignment.token_start_date %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          automated_tests/student_interface (AutomatedTestsController#student_interface)
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context50');toggle('message50');toggle('full_message50')" ><span id='message50' style='display:block' >Unescaped model attribute near line 33: t(&quot;automated_tests.token.tokens_available&quot;, :tokens =&gt; curren...</span><span id='full_message50' style='display:none'>Unescaped model attribute near line 33: t(&quot;automated_tests.token.tokens_available&quot;, :tokens =&gt; <span class="user_input">current_user.accepted_grouping_for(Assignment.find(params[:id]).id).test_tokens</span>)</span><table id='context50' class='context' style='display:none'><caption>app/views/automated_tests/student_interface.html.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>28</pre>
          </td>
          <td class='context'>
            <pre class='context'>            &lt;% if DateTime.now &lt; @assignment.token_start_date %&gt;</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>29</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= raw t(&#39;automated_tests.token.tokens_not_given_yet&#39;) %&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>30</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;% elsif @grouping.test_tokens &lt;= 0 %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>31</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= raw t(&#39;automated_tests.token.tokens_no_more_available&#39;) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>32</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;% else %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>33</pre>
            </td>
            <td class='context'>
              <pre class='context'>              &lt;%= raw t(&#39;automated_tests.token.tokens_available&#39;, tokens: @grouping.test_tokens) %&gt;</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>34</pre>
            </td>
            <td class='context'>
              <pre class='context'>            &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>35</pre>
            </td>
            <td class='context'>
              <pre class='context'>          &lt;/div&gt;</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>36</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;% end %&gt;</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>38</pre>
            </td>
            <td class='context'>
              <pre class='context'>        &lt;% if @assignment.unlimited_tokens || @grouping.test_tokens &gt; 0 %&gt;</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          notes/modal_dialogs/notes_dialog_success (NotesController#add_note)
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context51');toggle('message51');toggle('full_message51')" >Unescaped parameter value near line 3: escape_javascript(<span class="user_input">params[:number_of_notes_field]</span>)<table id='context51' class='context' style='display:none'><caption>app/views/notes/modal_dialogs/notes_dialog_success.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>modalNotesGroup.close();</pre>
          </td>
        </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>if (&lt;%= escape_javascript(@number_of_notes_field).html_safe %&gt;){</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= escape_javascript(@number_of_notes_field.to_s).html_safe %&gt;&#39;).html(</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>                       &#39;&lt;%= escape_javascript(@number_of_notes.to_s).html_safe %&gt;&#39;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>}</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>if (&lt;%= escape_javascript(@highlight_field).html_safe %&gt;){</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= escape_javascript(@highlight_field).html_safe %&gt;&#39;).effect(</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          notes/modal_dialogs/notes_dialog_success (NotesController#add_note)
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context52');toggle('message52');toggle('full_message52')" >Unescaped parameter value near line 4: escape_javascript(<span class="user_input">params[:number_of_notes_field].to_s</span>)<table id='context52' class='context' style='display:none'><caption>app/views/notes/modal_dialogs/notes_dialog_success.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>modalNotesGroup.close();</pre>
          </td>
        </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>if (&lt;%= escape_javascript(@number_of_notes_field).html_safe %&gt;){</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= escape_javascript(@number_of_notes_field.to_s).html_safe %&gt;&#39;).html(</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>                       &#39;&lt;%= escape_javascript(@number_of_notes.to_s).html_safe %&gt;&#39;);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>}</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>if (&lt;%= escape_javascript(@highlight_field).html_safe %&gt;){</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= escape_javascript(@highlight_field).html_safe %&gt;&#39;).effect(</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                   &quot;highlight&quot;, { color: &quot;#99CCFF&quot; }, 1000);</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          notes/modal_dialogs/notes_dialog_success (NotesController#add_note)
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context53');toggle('message53');toggle('full_message53')" >Unescaped model attribute near line 5: escape_javascript(<span class="user_input">Note.new.noteable</span>.notes.size.to_s)<table id='context53' class='context' style='display:none'><caption>app/views/notes/modal_dialogs/notes_dialog_success.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>1</pre>
          </td>
          <td class='context'>
            <pre class='context'>modalNotesGroup.close();</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>3</pre>
            </td>
            <td class='context'>
              <pre class='context'>if (&lt;%= escape_javascript(@number_of_notes_field).html_safe %&gt;){</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= escape_javascript(@number_of_notes_field.to_s).html_safe %&gt;&#39;).html(</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>                       &#39;&lt;%= escape_javascript(@number_of_notes.to_s).html_safe %&gt;&#39;);</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>}</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>if (&lt;%= escape_javascript(@highlight_field).html_safe %&gt;){</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= escape_javascript(@highlight_field).html_safe %&gt;&#39;).effect(</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                   &quot;highlight&quot;, { color: &quot;#99CCFF&quot; }, 1000);</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>}</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          notes/modal_dialogs/notes_dialog_success (NotesController#add_note)
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context54');toggle('message54');toggle('full_message54')" >Unescaped parameter value near line 7: escape_javascript(<span class="user_input">params[:highlight_field]</span>)<table id='context54' class='context' style='display:none'><caption>app/views/notes/modal_dialogs/notes_dialog_success.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>if (&lt;%= escape_javascript(@number_of_notes_field).html_safe %&gt;){</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= escape_javascript(@number_of_notes_field.to_s).html_safe %&gt;&#39;).html(</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>                       &#39;&lt;%= escape_javascript(@number_of_notes.to_s).html_safe %&gt;&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>}</pre>
            </td>
          </tr>
          <tr class='context error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>if (&lt;%= escape_javascript(@highlight_field).html_safe %&gt;){</pre>
            </td>
          </tr>
          <tr class='context alt near_error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= escape_javascript(@highlight_field).html_safe %&gt;&#39;).effect(</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                   &quot;highlight&quot;, { color: &quot;#99CCFF&quot; }, 1000);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>}</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
    <tr>
      <td><span class='weak-confidence'>Weak</span></td>
      <td>
        
          notes/modal_dialogs/notes_dialog_success (NotesController#add_note)
        
      </td>
      <td><a rel="no-referrer" href="https://brakemanscanner.org/docs/warning_types/cross_site_scripting">Cross-Site Scripting</a></td>
      <td><div class='warning_message' onClick="toggle('context55');toggle('message55');toggle('full_message55')" >Unescaped parameter value near line 8: escape_javascript(<span class="user_input">params[:highlight_field]</span>)<table id='context55' class='context' style='display:none'><caption>app/views/notes/modal_dialogs/notes_dialog_success.js.erb</caption>      <thead style='display:none'>
        <tr>
          <th>line number</th>
          <th>line content</th>
        </tr>
      </thead>
      <tbody>
        <tr class='context first'>
          <td class='context_line'>
            <pre class='context'>3</pre>
          </td>
          <td class='context'>
            <pre class='context'>if (&lt;%= escape_javascript(@number_of_notes_field).html_safe %&gt;){</pre>
          </td>
        </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>4</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= escape_javascript(@number_of_notes_field.to_s).html_safe %&gt;&#39;).html(</pre>
            </td>
          </tr>
          <tr class='context'>
            <td class='context_line'>
              <pre class='context'>5</pre>
            </td>
            <td class='context'>
              <pre class='context'>                       &#39;&lt;%= escape_javascript(@number_of_notes.to_s).html_safe %&gt;&#39;);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>6</pre>
            </td>
            <td class='context'>
              <pre class='context'>}</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>7</pre>
            </td>
            <td class='context'>
              <pre class='context'>if (&lt;%= escape_javascript(@highlight_field).html_safe %&gt;){</pre>
            </td>
          </tr>
          <tr class='context alt error'>
            <td class='context_line'>
              <pre class='context'>8</pre>
            </td>
            <td class='context'>
              <pre class='context'>  $(&#39;#&lt;%= escape_javascript(@highlight_field).html_safe %&gt;&#39;).effect(</pre>
            </td>
          </tr>
          <tr class='context near_error'>
            <td class='context_line'>
              <pre class='context'>9</pre>
            </td>
            <td class='context'>
              <pre class='context'>                                   &quot;highlight&quot;, { color: &quot;#99CCFF&quot; }, 1000);</pre>
            </td>
          </tr>
          <tr class='context alt'>
            <td class='context_line'>
              <pre class='context'>10</pre>
            </td>
            <td class='context'>
              <pre class='context'>}</pre>
            </td>
          </tr>
</tbody></table></div></td>
    </tr>
  
  </tbody>
</table>
</body></html>