<% content_for :head do %>
    <%= render partial: 'boot',
               formats: [:js],
               handlers: [:erb] %>
  <%= javascript_tag nonce: true do %>
    (function(){
      document.addEventListener('DOMContentLoaded', () => {
        makeTagTable(document.getElementById('tags_table'), {course_id: <%= @current_course.id %>, assignment_id: <%= @assignment.id %>});
      });
      const domContentLoadedCB = function() {
        $('#add-tag').click(function(e) {
          modal_create_new.open();
          e.preventDefault();
        })
      }

      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", domContentLoadedCB);
      }else{
        domContentLoadedCB()
      }
    })();
  <% end %>
<% end %>

<% content_for :title, Tag.model_name.human.pluralize + ': ' +
  (@assignment.is_peer_review? ?
     @assignment.parent_assignment.short_identifier + ' ' + PeerReview.model_name.human :
     @assignment.short_identifier) %>

<% @heading_buttons = [
  { link_text: t('helpers.submit.create', model: Tag.model_name.human),
    link_path: '#',
    html_options: { id: 'add-tag' } },
  { link_text: t('download'),
    link_path: '#',
    html_options: { id: 'downloadModal' } },
  { link_text: t('upload'),
    link_path: '#',
    html_options: { id: 'uploadModal' } }
] %>

<% content_for :wrap_left_content do %>
  <!--The table that contains all the tags.-->
  <div id='tags_table'></div>
<% end %>

<!-- Modals -->
<%= render partial: 'create_new_modal', layout: 'layouts/modal_dialog'  %>
<%= render partial: 'download_modal', layout: 'layouts/modal_dialog'  %>
<%= render partial: 'upload_modal', layout: 'layouts/modal_dialog'  %>

<aside class='dialog' id='edit_tags_dialog'></aside>
