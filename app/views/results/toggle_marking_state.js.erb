<%# Hide error message (if any) %>
document.getElementById('criterion_incomplete_error').addClass('hidden');
<% if @result.marking_state == Result::MARKING_STATES[:complete] %>
  var revert = I18n.t('results.set_to_incomplete');
  document.getElementById('toggle_marking_state').firstChild.value = revert;
  if (document.getElementById('toggle_released')) {
    document.getElementById('toggle_released').firstChild.disabled = false;
  }
<% else %>
  var set = I18n.t('results.set_to_complete');
  document.getElementById('toggle_marking_state').firstChild.value = set;
  if (document.getElementById('toggle_released')) {
    document.getElementById('toggle_released').firstChild.disabled = true;
  }
<% end %>

<%
  @assignment = @result.submission.assignment
  if @result.is_a_review?
    @assignment = @assignment.pr_assignment
  end
  if @current_user.admin?
    num_marked = @assignment.get_num_marked
    num_assigned = @assignment.get_num_assigned
  elsif @current_user.is_reviewer_for?(@assignment, @result)
    num_marked = @assignment.get_num_marked(nil, @current_user.grouping_for(@assignment.id))
    num_assigned = @assignment.get_num_assigned(nil, @current_user.grouping_for(@assignment.id))
  else
    num_marked = @assignment.get_num_marked(@current_user.id)
    num_assigned = @assignment.get_num_assigned(@current_user.id)
  end
%>

update_bar(<%= num_marked %>, <%= num_assigned %>);
